

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Reference &mdash; PropFlow 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=01f34227"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Examples" href="../examples.html" />
    <link rel="prev" title="User Guide" href="../user_guide.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            PropFlow
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#from-pypi-recommended">From PyPI (Recommended)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#from-source">From Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#development-installation">Development Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#verifying-installation">Verifying Installation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick Start Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#your-first-factor-graph">Your First Factor Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#using-the-graph-builder">Using the Graph Builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#applying-policies">Applying Policies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#running-experiments">Running Experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide.html">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide.html#core-concepts">Core Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide.html#factor-graphs">Factor Graphs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide.html#variables">Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide.html#factors">Factors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide.html#belief-propagation-algorithms">Belief Propagation Algorithms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide.html#min-sum">Min-Sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide.html#max-sum">Max-Sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide.html#sum-product">Sum-Product</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide.html#policies-and-engine-variants">Policies and Engine Variants</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide.html#damping">Damping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide.html#factor-splitting">Factor Splitting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide.html#cost-reduction">Cost Reduction</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide.html#convergence-monitoring">Convergence Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide.html#graph-construction">Graph Construction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide.html#cycle-graphs">Cycle Graphs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide.html#random-graphs">Random Graphs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide.html#custom-graphs">Custom Graphs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide.html#advanced-topics">Advanced Topics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide.html#custom-cost-tables">Custom Cost Tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide.html#snapshots-and-analysis">Snapshots and Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide.html#search-algorithms">Search Algorithms</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#core-modules">Core Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-propflow.bp.engine_base">Engines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#propflow.bp.engine_base.BPEngine"><code class="docutils literal notranslate"><span class="pre">BPEngine</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#propflow.bp.engines.Engine"><code class="docutils literal notranslate"><span class="pre">Engine</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#propflow.bp.engines.SplitEngine"><code class="docutils literal notranslate"><span class="pre">SplitEngine</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#propflow.bp.engines.CostReductionOnceEngine"><code class="docutils literal notranslate"><span class="pre">CostReductionOnceEngine</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#propflow.bp.engines.DampingEngine"><code class="docutils literal notranslate"><span class="pre">DampingEngine</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#propflow.bp.engines.DampingSCFGEngine"><code class="docutils literal notranslate"><span class="pre">DampingSCFGEngine</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#propflow.bp.engines.DampingCROnceEngine"><code class="docutils literal notranslate"><span class="pre">DampingCROnceEngine</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#propflow.bp.engines.MessagePruningEngine"><code class="docutils literal notranslate"><span class="pre">MessagePruningEngine</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#propflow.bp.engines.DiscountEngine"><code class="docutils literal notranslate"><span class="pre">DiscountEngine</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-propflow.bp.factor_graph">Factor Graphs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#propflow.bp.factor_graph.FactorGraph"><code class="docutils literal notranslate"><span class="pre">FactorGraph</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-propflow.core.agents">Agents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#propflow.core.agents.FGAgent"><code class="docutils literal notranslate"><span class="pre">FGAgent</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#propflow.core.agents.VariableAgent"><code class="docutils literal notranslate"><span class="pre">VariableAgent</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#propflow.core.agents.FactorAgent"><code class="docutils literal notranslate"><span class="pre">FactorAgent</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-propflow.core.components">Components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#propflow.core.components.Message"><code class="docutils literal notranslate"><span class="pre">Message</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#propflow.core.components.MailHandler"><code class="docutils literal notranslate"><span class="pre">MailHandler</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-propflow.policies">Policies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#propflow.policies.damp"><code class="docutils literal notranslate"><span class="pre">damp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#propflow.policies.TD"><code class="docutils literal notranslate"><span class="pre">TD()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#propflow.policies.cost_reduction_all_factors_once"><code class="docutils literal notranslate"><span class="pre">cost_reduction_all_factors_once()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#propflow.policies.discount_attentive"><code class="docutils literal notranslate"><span class="pre">discount_attentive()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#propflow.policies.split_all_factors"><code class="docutils literal notranslate"><span class="pre">split_all_factors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#propflow.policies.MessagePruningPolicy"><code class="docutils literal notranslate"><span class="pre">MessagePruningPolicy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#propflow.policies.normalize_inbox"><code class="docutils literal notranslate"><span class="pre">normalize_inbox()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#propflow.policies.normalize_soft_max"><code class="docutils literal notranslate"><span class="pre">normalize_soft_max()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#propflow.policies.normalize_cost_table_sum"><code class="docutils literal notranslate"><span class="pre">normalize_cost_table_sum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#propflow.policies.init_normalization"><code class="docutils literal notranslate"><span class="pre">init_normalization()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-propflow.utils">Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-propflow.simulator">Simulator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#propflow.simulator.Simulator"><code class="docutils literal notranslate"><span class="pre">Simulator</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#basic-graph-coloring">Basic Graph Coloring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#comparing-engine-variants">Comparing Engine Variants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#custom-cost-function">Custom Cost Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#large-scale-problem">Large-Scale Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#analyzing-convergence">Analyzing Convergence</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#development-workflow">Development Workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../contributing.html#running-tests">Running Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing.html#code-quality">Code Quality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing.html#documentation">Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#contribution-guidelines">Contribution Guidelines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../contributing.html#code-style">Code Style</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing.html#commit-messages">Commit Messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing.html#pull-requests">Pull Requests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing.html#testing">Testing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#what-to-contribute">What to Contribute</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../contributing.html#need-ideas">Need Ideas?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#questions">Questions?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#license">License</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PropFlow</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API Reference</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/OrMullerHahitti/Belief-Propagation-Simulator/blob/main/docs/api/index.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading"></a></h1>
<p>This section contains the complete API documentation for PropFlow.</p>
<div class="toctree-wrapper compound">
</div>
<section id="core-modules">
<h2>Core Modules<a class="headerlink" href="#core-modules" title="Link to this heading"></a></h2>
<section id="module-propflow.bp.engine_base">
<span id="engines"></span><h3>Engines<a class="headerlink" href="#module-propflow.bp.engine_base" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">propflow.bp.engine_base.</span></span><span class="sig-name descname"><span class="pre">BPEngine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor_graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computator=&lt;propflow.bp.computators.MinSumComputator</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_normalization=&lt;function</span> <span class="pre">dummy_func&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name='BPEngine'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence_config=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_performance=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_messages=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anytime=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bct_history=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snapshots_config=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engine_base.html#BPEngine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engine_base.BPEngine" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>The core engine for running belief propagation simulations.</p>
<p>This class orchestrates the belief propagation process on a factor graph.
It manages the simulation loop, message passing schedule, history tracking,
convergence checking, and performance monitoring. It is designed to be
extended by other engine classes that implement specific BP variants or policies.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.computator">
<span class="sig-name descname"><span class="pre">computator</span></span><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.computator" title="Link to this definition"></a></dt>
<dd><p>The computator instance for message calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Computator</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.anytime">
<span class="sig-name descname"><span class="pre">anytime</span></span><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.anytime" title="Link to this definition"></a></dt>
<dd><p>If True, the engine tracks the best cost found so far.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.normalize_messages">
<span class="sig-name descname"><span class="pre">normalize_messages</span></span><a class="reference internal" href="../_modules/propflow/bp/engine_base.html#BPEngine.normalize_messages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.normalize_messages" title="Link to this definition"></a></dt>
<dd><p>If True, messages are normalized each cycle.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.graph">
<span class="sig-name descname"><span class="pre">graph</span></span><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.graph" title="Link to this definition"></a></dt>
<dd><p>The factor graph on which the simulation runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#propflow.bp.factor_graph.FactorGraph" title="propflow.bp.factor_graph.FactorGraph">FactorGraph</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.var_nodes">
<span class="sig-name descname"><span class="pre">var_nodes</span></span><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.var_nodes" title="Link to this definition"></a></dt>
<dd><p>A list of variable agent nodes in the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.factor_nodes">
<span class="sig-name descname"><span class="pre">factor_nodes</span></span><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.factor_nodes" title="Link to this definition"></a></dt>
<dd><p>A list of factor agent nodes in the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.history">
<span class="sig-name descname"><span class="pre">history</span></span><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.history" title="Link to this definition"></a></dt>
<dd><p>An object for tracking the simulation’s history.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>History</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.graph_diameter">
<span class="sig-name descname"><span class="pre">graph_diameter</span></span><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.graph_diameter" title="Link to this definition"></a></dt>
<dd><p>The diameter of the factor graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.convergence_monitor">
<span class="sig-name descname"><span class="pre">convergence_monitor</span></span><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.convergence_monitor" title="Link to this definition"></a></dt>
<dd><p>The monitor for checking convergence.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ConvergenceMonitor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.performance_monitor">
<span class="sig-name descname"><span class="pre">performance_monitor</span></span><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.performance_monitor" title="Link to this definition"></a></dt>
<dd><p>An optional monitor for performance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>PerformanceMonitor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engine_base.html#BPEngine.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.step" title="Link to this definition"></a></dt>
<dd><p>Runs one full step of the synchronous belief propagation algorithm.</p>
<p>A step consists of two main phases:
1. Variable nodes compute and send messages to factor nodes.
2. Factor nodes compute and send messages to variable nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>i</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – The current step number.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Step</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A <cite>Step</cite> object containing information about the messages exchanged.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_json</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_csv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engine_base.html#BPEngine.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.run" title="Link to this definition"></a></dt>
<dd><p>Runs the simulation until convergence or max iterations is reached.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_iter</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – The maximum number of iterations to run.</p></li>
<li><p><strong>save_json</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Whether to save the full history as a JSON file.</p></li>
<li><p><strong>save_csv</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Whether to save the cost history as a CSV file.</p></li>
<li><p><strong>filename</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The base name for the output files.</p></li>
<li><p><strong>config_name</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The name of the configuration to use for saving.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>An optional string, typically for results or status.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.name">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.name" title="Link to this definition"></a></dt>
<dd><p>The name of the engine instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.iteration_count">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">iteration_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.iteration_count" title="Link to this definition"></a></dt>
<dd><p>The number of iterations completed so far.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.get_beliefs">
<span class="sig-name descname"><span class="pre">get_beliefs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engine_base.html#BPEngine.get_beliefs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.get_beliefs" title="Link to this definition"></a></dt>
<dd><p>Retrieves the current beliefs of all variable nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]</span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary mapping variable names to their belief vectors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.assignments">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">assignments</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.assignments" title="Link to this definition"></a></dt>
<dd><p>The current assignments of all variable nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.calculate_global_cost">
<span class="sig-name descname"><span class="pre">calculate_global_cost</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engine_base.html#BPEngine.calculate_global_cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.calculate_global_cost" title="Link to this definition"></a></dt>
<dd><p>Calculates the global cost based on the current variable assignments.</p>
<p>This method uses the original, unmodified factor cost tables to ensure
the true cost is computed, independent of any runtime cost modifications.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total cost of the current assignments.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.post_init">
<span class="sig-name descname"><span class="pre">post_init</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engine_base.html#BPEngine.post_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.post_init" title="Link to this definition"></a></dt>
<dd><p>Hook for logic to be executed after engine initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.post_factor_cycle">
<span class="sig-name descname"><span class="pre">post_factor_cycle</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engine_base.html#BPEngine.post_factor_cycle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.post_factor_cycle" title="Link to this definition"></a></dt>
<dd><p>Hook for logic after a full message passing cycle.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.post_two_cycles">
<span class="sig-name descname"><span class="pre">post_two_cycles</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engine_base.html#BPEngine.post_two_cycles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.post_two_cycles" title="Link to this definition"></a></dt>
<dd><p>Hook for logic after the first two message passing cycles.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.pre_factor_compute">
<span class="sig-name descname"><span class="pre">pre_factor_compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engine_base.html#BPEngine.pre_factor_compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.pre_factor_compute" title="Link to this definition"></a></dt>
<dd><p>Hook for logic before a factor computes its messages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>factor</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#propflow.core.agents.FactorAgent" title="propflow.core.agents.FactorAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">FactorAgent</span></code></a></span>) – The factor agent about to compute messages.</p></li>
<li><p><strong>iteration</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – The current simulation iteration.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.post_factor_compute">
<span class="sig-name descname"><span class="pre">post_factor_compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engine_base.html#BPEngine.post_factor_compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.post_factor_compute" title="Link to this definition"></a></dt>
<dd><p>Hook for logic after a factor computes its messages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>factor</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#propflow.core.agents.FactorAgent" title="propflow.core.agents.FactorAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">FactorAgent</span></code></a></span>) – The factor agent that just computed messages.</p></li>
<li><p><strong>iteration</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – The current simulation iteration.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.pre_var_compute">
<span class="sig-name descname"><span class="pre">pre_var_compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engine_base.html#BPEngine.pre_var_compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.pre_var_compute" title="Link to this definition"></a></dt>
<dd><p>Hook for logic before a variable computes its messages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>var</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#propflow.core.agents.VariableAgent" title="propflow.core.agents.VariableAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">VariableAgent</span></code></a></span>) – The variable agent about to compute messages.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.post_var_compute">
<span class="sig-name descname"><span class="pre">post_var_compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engine_base.html#BPEngine.post_var_compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.post_var_compute" title="Link to this definition"></a></dt>
<dd><p>Hook for logic after a variable computes its messages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>var</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#propflow.core.agents.VariableAgent" title="propflow.core.agents.VariableAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">VariableAgent</span></code></a></span>) – The variable agent that just computed messages.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.init_normalize">
<span class="sig-name descname"><span class="pre">init_normalize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engine_base.html#BPEngine.init_normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.init_normalize" title="Link to this definition"></a></dt>
<dd><p>Hook for initial normalization logic.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.update_global_cost">
<span class="sig-name descname"><span class="pre">update_global_cost</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engine_base.html#BPEngine.update_global_cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.update_global_cost" title="Link to this definition"></a></dt>
<dd><p>Calculates and records the global cost for the current step.</p>
<p>If in “anytime” mode, it ensures the cost recorded does not increase.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">normalize_messages</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engine_base.html#BPEngine.normalize_messages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Placeholder hook for message normalization logic.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.latest_snapshot">
<span class="sig-name descname"><span class="pre">latest_snapshot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engine_base.html#BPEngine.latest_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.latest_snapshot" title="Link to this definition"></a></dt>
<dd><p>Returns the latest snapshot record if snapshots are enabled.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The latest snapshot object, or None if snapshots are disabled.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.engine_base.BPEngine.get_snapshot">
<span class="sig-name descname"><span class="pre">get_snapshot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engine_base.html#BPEngine.get_snapshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engine_base.BPEngine.get_snapshot" title="Link to this definition"></a></dt>
<dd><p>Returns the snapshot record for a given step index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>step_index</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – The step for which to retrieve the snapshot.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The snapshot object for the given step, or None if not available.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-propflow.bp.engines">
<dt class="sig sig-object py" id="propflow.bp.engines.Engine">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">propflow.bp.engines.</span></span><span class="sig-name descname"><span class="pre">Engine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor_graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computator=&lt;propflow.bp.computators.MinSumComputator</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_normalization=&lt;function</span> <span class="pre">dummy_func&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name='BPEngine'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence_config=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_performance=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_messages=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anytime=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bct_history=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snapshots_config=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engines.html#Engine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engines.Engine" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#propflow.bp.engine_base.BPEngine" title="propflow.bp.engine_base.BPEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">BPEngine</span></code></a></p>
<p>A basic belief propagation engine.</p>
<p>This is a direct alias for <cite>BPEngine</cite> and provides the standard,
unmodified belief propagation behavior.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="propflow.bp.engines.SplitEngine">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">propflow.bp.engines.</span></span><span class="sig-name descname"><span class="pre">SplitEngine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engines.html#SplitEngine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engines.SplitEngine" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#propflow.bp.engine_base.BPEngine" title="propflow.bp.engine_base.BPEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">BPEngine</span></code></a></p>
<p>A BP engine that applies the factor splitting policy.</p>
<p>This engine modifies the factor graph by splitting each factor into two,
distributing the original cost between them. This can sometimes help with
convergence.</p>
<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.engines.SplitEngine.post_init">
<span class="sig-name descname"><span class="pre">post_init</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engines.html#SplitEngine.post_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engines.SplitEngine.post_init" title="Link to this definition"></a></dt>
<dd><p>Applies the factor splitting policy after initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="propflow.bp.engines.CostReductionOnceEngine">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">propflow.bp.engines.</span></span><span class="sig-name descname"><span class="pre">CostReductionOnceEngine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engines.html#CostReductionOnceEngine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engines.CostReductionOnceEngine" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#propflow.bp.engine_base.BPEngine" title="propflow.bp.engine_base.BPEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">BPEngine</span></code></a></p>
<p>A BP engine that applies a one-time cost reduction policy.</p>
<p>This engine reduces the costs in the factor tables at the beginning of the
simulation and then applies a discount to outgoing messages from factors.</p>
<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.engines.CostReductionOnceEngine.post_init">
<span class="sig-name descname"><span class="pre">post_init</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engines.html#CostReductionOnceEngine.post_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engines.CostReductionOnceEngine.post_init" title="Link to this definition"></a></dt>
<dd><p>Applies the one-time cost reduction after initialization.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.engines.CostReductionOnceEngine.post_factor_compute">
<span class="sig-name descname"><span class="pre">post_factor_compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engines.html#CostReductionOnceEngine.post_factor_compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engines.CostReductionOnceEngine.post_factor_compute" title="Link to this definition"></a></dt>
<dd><p>Applies a discount to outgoing messages from factors.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="propflow.bp.engines.DampingEngine">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">propflow.bp.engines.</span></span><span class="sig-name descname"><span class="pre">DampingEngine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damping_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engines.html#DampingEngine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engines.DampingEngine" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#propflow.bp.engine_base.BPEngine" title="propflow.bp.engine_base.BPEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">BPEngine</span></code></a></p>
<p>A BP engine that applies message damping.</p>
<p>Damping averages the message from the previous iteration with the newly
computed message. This can help prevent oscillations and improve convergence.</p>
<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.engines.DampingEngine.post_var_compute">
<span class="sig-name descname"><span class="pre">post_var_compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engines.html#DampingEngine.post_var_compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engines.DampingEngine.post_var_compute" title="Link to this definition"></a></dt>
<dd><p>Applies damping after a variable node computes its messages.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="propflow.bp.engines.DampingSCFGEngine">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">propflow.bp.engines.</span></span><span class="sig-name descname"><span class="pre">DampingSCFGEngine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engines.html#DampingSCFGEngine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engines.DampingSCFGEngine" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#propflow.bp.engines.DampingEngine" title="propflow.bp.engines.DampingEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">DampingEngine</span></code></a>, <a class="reference internal" href="#propflow.bp.engines.SplitEngine" title="propflow.bp.engines.SplitEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">SplitEngine</span></code></a></p>
<p>A BP engine that combines message damping and factor splitting.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="propflow.bp.engines.DampingCROnceEngine">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">propflow.bp.engines.</span></span><span class="sig-name descname"><span class="pre">DampingCROnceEngine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engines.html#DampingCROnceEngine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engines.DampingCROnceEngine" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#propflow.bp.engines.DampingEngine" title="propflow.bp.engines.DampingEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">DampingEngine</span></code></a>, <a class="reference internal" href="#propflow.bp.engines.CostReductionOnceEngine" title="propflow.bp.engines.CostReductionOnceEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">CostReductionOnceEngine</span></code></a></p>
<p>A BP engine that combines message damping and one-time cost reduction.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="propflow.bp.engines.MessagePruningEngine">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">propflow.bp.engines.</span></span><span class="sig-name descname"><span class="pre">MessagePruningEngine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engines.html#MessagePruningEngine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engines.MessagePruningEngine" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#propflow.bp.engine_base.BPEngine" title="propflow.bp.engine_base.BPEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">BPEngine</span></code></a></p>
<p>A BP engine that applies a message pruning policy to reduce memory usage.</p>
<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.engines.MessagePruningEngine.post_init">
<span class="sig-name descname"><span class="pre">post_init</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engines.html#MessagePruningEngine.post_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engines.MessagePruningEngine.post_init" title="Link to this definition"></a></dt>
<dd><p>Initializes and sets the message pruning policy on agent mailers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="propflow.bp.engines.DiscountEngine">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">propflow.bp.engines.</span></span><span class="sig-name descname"><span class="pre">DiscountEngine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engines.html#DiscountEngine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engines.DiscountEngine" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#propflow.bp.engine_base.BPEngine" title="propflow.bp.engine_base.BPEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">BPEngine</span></code></a></p>
<p>A BP engine that applies a discount factor to messages over time.</p>
<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.engines.DiscountEngine.post_factor_cycle">
<span class="sig-name descname"><span class="pre">post_factor_cycle</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/engines.html#DiscountEngine.post_factor_cycle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.engines.DiscountEngine.post_factor_cycle" title="Link to this definition"></a></dt>
<dd><p>Applies the discount policy after each message passing cycle.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-propflow.bp.factor_graph">
<span id="factor-graphs"></span><h3>Factor Graphs<a class="headerlink" href="#module-propflow.bp.factor_graph" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="propflow.bp.factor_graph.FactorGraph">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">propflow.bp.factor_graph.</span></span><span class="sig-name descname"><span class="pre">FactorGraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_li</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor_li</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/factor_graph.html#FactorGraph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.factor_graph.FactorGraph" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Represents a bipartite factor graph for belief propagation.</p>
<p>This class encapsulates the structure of a factor graph, which consists of
variable nodes and factor nodes. It enforces a bipartite structure where
variables are only connected to factors and vice versa. It uses a
<cite>networkx.Graph</cite> to manage the underlying connections.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.bp.factor_graph.FactorGraph.variables">
<span class="sig-name descname"><span class="pre">variables</span></span><a class="headerlink" href="#propflow.bp.factor_graph.FactorGraph.variables" title="Link to this definition"></a></dt>
<dd><p>A list of all variable agents in the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#propflow.core.agents.VariableAgent" title="propflow.core.agents.VariableAgent">VariableAgent</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.bp.factor_graph.FactorGraph.factors">
<span class="sig-name descname"><span class="pre">factors</span></span><a class="headerlink" href="#propflow.bp.factor_graph.FactorGraph.factors" title="Link to this definition"></a></dt>
<dd><p>A list of all factor agents in the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#propflow.core.agents.FactorAgent" title="propflow.core.agents.FactorAgent">FactorAgent</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.bp.factor_graph.FactorGraph.G">
<span class="sig-name descname"><span class="pre">G</span></span><a class="headerlink" href="#propflow.bp.factor_graph.FactorGraph.G" title="Link to this definition"></a></dt>
<dd><p>The underlying networkx graph structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nx.Graph</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="propflow.bp.factor_graph.FactorGraph.lb">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lb</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><a class="headerlink" href="#propflow.bp.factor_graph.FactorGraph.lb" title="Link to this definition"></a></dt>
<dd><p>The lower bound of the problem, can be set externally.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="propflow.bp.factor_graph.FactorGraph.global_cost">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">global_cost</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><a class="headerlink" href="#propflow.bp.factor_graph.FactorGraph.global_cost" title="Link to this definition"></a></dt>
<dd><p>Calculates the global cost based on current variable assignments.</p>
<p>This property queries each variable for its current assignment and uses
the original, unmodified factor cost tables to compute the total cost.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="propflow.bp.factor_graph.FactorGraph.curr_assignment">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">curr_assignment</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#propflow.core.agents.VariableAgent" title="propflow.core.agents.VariableAgent"><span class="pre">VariableAgent</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#propflow.bp.factor_graph.FactorGraph.curr_assignment" title="Link to this definition"></a></dt>
<dd><p>The current assignment for all variables in the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="propflow.bp.factor_graph.FactorGraph.edges">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">edges</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#propflow.core.agents.FactorAgent" title="propflow.core.agents.FactorAgent"><span class="pre">FactorAgent</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#propflow.core.agents.VariableAgent" title="propflow.core.agents.VariableAgent"><span class="pre">VariableAgent</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#propflow.bp.factor_graph.FactorGraph.edges" title="Link to this definition"></a></dt>
<dd><p>Reconstructs the edge dictionary mapping factors to variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.factor_graph.FactorGraph.set_computator">
<span class="sig-name descname"><span class="pre">set_computator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">computator</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/factor_graph.html#FactorGraph.set_computator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.factor_graph.FactorGraph.set_computator" title="Link to this definition"></a></dt>
<dd><p>Assigns a computator to all nodes in the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>computator</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Computator</span></code></span>) – The computator instance to assign.</p></li>
<li><p><strong>**kwargs</strong> – Additional arguments (not currently used).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.factor_graph.FactorGraph.normalize_messages">
<span class="sig-name descname"><span class="pre">normalize_messages</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/factor_graph.html#FactorGraph.normalize_messages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.factor_graph.FactorGraph.normalize_messages" title="Link to this definition"></a></dt>
<dd><p>Normalizes all incoming messages for all variable nodes.</p>
<p>This is a common technique to prevent numerical instability in belief
propagation algorithms by shifting message values.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.factor_graph.FactorGraph.visualize">
<span class="sig-name descname"><span class="pre">visualize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/factor_graph.html#FactorGraph.visualize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.factor_graph.FactorGraph.visualize" title="Link to this definition"></a></dt>
<dd><p>Visualizes the factor graph using matplotlib.</p>
<p>Variable nodes are drawn as circles, and factor nodes are drawn as squares.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.factor_graph.FactorGraph.get_variable_agents">
<span class="sig-name descname"><span class="pre">get_variable_agents</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/factor_graph.html#FactorGraph.get_variable_agents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.factor_graph.FactorGraph.get_variable_agents" title="Link to this definition"></a></dt>
<dd><p>Returns a list of all variable agents in the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference internal" href="#propflow.core.agents.VariableAgent" title="propflow.core.agents.VariableAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">VariableAgent</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.bp.factor_graph.FactorGraph.get_factor_agents">
<span class="sig-name descname"><span class="pre">get_factor_agents</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/bp/factor_graph.html#FactorGraph.get_factor_agents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.bp.factor_graph.FactorGraph.get_factor_agents" title="Link to this definition"></a></dt>
<dd><p>Returns a list of all factor agents in the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference internal" href="#propflow.core.agents.FactorAgent" title="propflow.core.agents.FactorAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">FactorAgent</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="propflow.bp.factor_graph.FactorGraph.diameter">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">diameter</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#propflow.bp.factor_graph.FactorGraph.diameter" title="Link to this definition"></a></dt>
<dd><p>The diameter of the factor graph.</p>
<p>If the graph is not connected, it returns the diameter of the
largest connected component.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="propflow.bp.factor_graph.FactorGraph.original_factors">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">original_factors</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#propflow.core.agents.FactorAgent" title="propflow.core.agents.FactorAgent"><span class="pre">FactorAgent</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#propflow.bp.factor_graph.FactorGraph.original_factors" title="Link to this definition"></a></dt>
<dd><p>A deep copy of the original factor agents.</p>
<p>This is preserved to allow for calculating the true global cost,
even if factor costs are modified during a simulation run.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a>[<a class="reference internal" href="#propflow.core.agents.FactorAgent" title="propflow.core.agents.FactorAgent">FactorAgent</a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-propflow.core.agents">
<span id="agents"></span><h3>Agents<a class="headerlink" href="#module-propflow.core.agents" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="propflow.core.agents.FGAgent">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">propflow.core.agents.</span></span><span class="sig-name descname"><span class="pre">FGAgent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/agents.html#FGAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.agents.FGAgent" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Agent</span></code>, <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Abstract base class for belief propagation (BP) nodes.</p>
<p>Extends the <cite>Agent</cite> class with methods relevant to message passing,
updating local belief, and retrieving that belief. It serves as a
foundation for both <cite>VariableAgent</cite> and <cite>FactorAgent</cite> classes.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.core.agents.FGAgent.domain">
<span class="sig-name descname"><span class="pre">domain</span></span><a class="headerlink" href="#propflow.core.agents.FGAgent.domain" title="Link to this definition"></a></dt>
<dd><p>The size of the variable domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.core.agents.FGAgent.mailer">
<span class="sig-name descname"><span class="pre">mailer</span></span><a class="headerlink" href="#propflow.core.agents.FGAgent.mailer" title="Link to this definition"></a></dt>
<dd><p>Handles incoming and outgoing messages.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#propflow.core.components.MailHandler" title="propflow.core.components.MailHandler">MailHandler</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.agents.FGAgent.receive_message">
<span class="sig-name descname"><span class="pre">receive_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/agents.html#FGAgent.receive_message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.agents.FGAgent.receive_message" title="Link to this definition"></a></dt>
<dd><p>Receives a message and adds it to the mailer’s inbox.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>message</strong> (<a class="reference internal" href="#propflow.core.components.Message" title="propflow.core.components.Message"><em>Message</em></a>) – The message to be received.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.agents.FGAgent.send_message">
<span class="sig-name descname"><span class="pre">send_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/agents.html#FGAgent.send_message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.agents.FGAgent.send_message" title="Link to this definition"></a></dt>
<dd><p>Sends a message to its recipient via the mailer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>message</strong> (<a class="reference internal" href="#propflow.core.components.Message" title="propflow.core.components.Message"><em>Message</em></a>) – The message to be sent.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.agents.FGAgent.empty_mailbox">
<span class="sig-name descname"><span class="pre">empty_mailbox</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/agents.html#FGAgent.empty_mailbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.agents.FGAgent.empty_mailbox" title="Link to this definition"></a></dt>
<dd><p>Clears all messages from the mailer’s inbox.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.agents.FGAgent.empty_outgoing">
<span class="sig-name descname"><span class="pre">empty_outgoing</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/agents.html#FGAgent.empty_outgoing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.agents.FGAgent.empty_outgoing" title="Link to this definition"></a></dt>
<dd><p>Clears all messages from the mailer’s outbox.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="propflow.core.agents.FGAgent.inbox">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inbox</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#propflow.core.components.Message" title="propflow.core.components.Message"><span class="pre">Message</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#propflow.core.agents.FGAgent.inbox" title="Link to this definition"></a></dt>
<dd><p>A list of incoming messages.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a>[<a class="reference internal" href="#propflow.core.components.Message" title="propflow.core.components.Message">Message</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="propflow.core.agents.FGAgent.outbox">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">outbox</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#propflow.core.components.Message" title="propflow.core.components.Message"><span class="pre">Message</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#propflow.core.agents.FGAgent.outbox" title="Link to this definition"></a></dt>
<dd><p>A list of outgoing messages.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a>[<a class="reference internal" href="#propflow.core.components.Message" title="propflow.core.components.Message">Message</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.agents.FGAgent.compute_messages">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compute_messages</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/agents.html#FGAgent.compute_messages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.agents.FGAgent.compute_messages" title="Link to this definition"></a></dt>
<dd><p>Abstract method to compute outgoing messages.</p>
<p>This method must be implemented by subclasses to define how
messages are calculated based on the agent’s current state
and incoming messages.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference internal" href="#propflow.core.components.Message" title="propflow.core.components.Message"><code class="xref py py-class docutils literal notranslate"><span class="pre">Message</span></code></a>]</span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of messages to be sent.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="propflow.core.agents.FGAgent.last_iteration">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">last_iteration</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#propflow.core.components.Message" title="propflow.core.components.Message"><span class="pre">Message</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#propflow.core.agents.FGAgent.last_iteration" title="Link to this definition"></a></dt>
<dd><p>The last list of messages sent.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a>[<a class="reference internal" href="#propflow.core.components.Message" title="propflow.core.components.Message">Message</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.agents.FGAgent.last_cycle">
<span class="sig-name descname"><span class="pre">last_cycle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/agents.html#FGAgent.last_cycle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.agents.FGAgent.last_cycle" title="Link to this definition"></a></dt>
<dd><p>Retrieves messages from a previous cycle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>diameter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The number of iterations in a cycle. Defaults to 1.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference internal" href="#propflow.core.components.Message" title="propflow.core.components.Message"><code class="xref py py-class docutils literal notranslate"><span class="pre">Message</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of messages from the specified previous cycle.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.agents.FGAgent.append_last_iteration">
<span class="sig-name descname"><span class="pre">append_last_iteration</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/agents.html#FGAgent.append_last_iteration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.agents.FGAgent.append_last_iteration" title="Link to this definition"></a></dt>
<dd><p>Appends the current outbox to the history.</p>
<p>Maintains a history of sent messages, limited by <cite>_max_history</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="propflow.core.agents.VariableAgent">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">propflow.core.agents.</span></span><span class="sig-name descname"><span class="pre">VariableAgent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/agents.html#VariableAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.agents.VariableAgent" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#propflow.core.agents.FGAgent" title="propflow.core.agents.FGAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">FGAgent</span></code></a></p>
<p>Represents a variable node in a factor graph.</p>
<p>This agent is responsible for aggregating messages from neighboring
factor nodes to compute its belief over its domain.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.core.agents.VariableAgent.computator">
<span class="sig-name descname"><span class="pre">computator</span></span><a class="headerlink" href="#propflow.core.agents.VariableAgent.computator" title="Link to this definition"></a></dt>
<dd><p>An object that handles the computation of messages and beliefs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.agents.VariableAgent.compute_messages">
<span class="sig-name descname"><span class="pre">compute_messages</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/agents.html#VariableAgent.compute_messages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.agents.VariableAgent.compute_messages" title="Link to this definition"></a></dt>
<dd><p>Computes outgoing messages to factor nodes.</p>
<p>Uses the assigned <cite>computator</cite> to calculate messages based on
the contents of the inbox.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="propflow.core.agents.VariableAgent.belief">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">belief</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#propflow.core.agents.VariableAgent.belief" title="Link to this definition"></a></dt>
<dd><p>The current belief distribution over the variable’s domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="propflow.core.agents.VariableAgent.curr_assignment">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">curr_assignment</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><a class="headerlink" href="#propflow.core.agents.VariableAgent.curr_assignment" title="Link to this definition"></a></dt>
<dd><p>The current assignment for the variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a> | <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="propflow.core.agents.FactorAgent">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">propflow.core.agents.</span></span><span class="sig-name descname"><span class="pre">FactorAgent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ct_creation_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cost_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/agents.html#FactorAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.agents.FactorAgent" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#propflow.core.agents.FGAgent" title="propflow.core.agents.FGAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">FGAgent</span></code></a></p>
<p>Represents a factor node in a factor graph.</p>
<p>This agent stores a cost function (or utility function) that defines
the relationship between a set of connected variable nodes.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.core.agents.FactorAgent.cost_table">
<span class="sig-name descname"><span class="pre">cost_table</span></span><a class="headerlink" href="#propflow.core.agents.FactorAgent.cost_table" title="Link to this definition"></a></dt>
<dd><p>The table of costs for each combination of assignments.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>CostTable</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.core.agents.FactorAgent.connection_number">
<span class="sig-name descname"><span class="pre">connection_number</span></span><a class="headerlink" href="#propflow.core.agents.FactorAgent.connection_number" title="Link to this definition"></a></dt>
<dd><p>A mapping from variable names to their dimension index.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.core.agents.FactorAgent.ct_creation_func">
<span class="sig-name descname"><span class="pre">ct_creation_func</span></span><a class="headerlink" href="#propflow.core.agents.FactorAgent.ct_creation_func" title="Link to this definition"></a></dt>
<dd><p>A function to create the cost table.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.core.agents.FactorAgent.ct_creation_params">
<span class="sig-name descname"><span class="pre">ct_creation_params</span></span><a class="headerlink" href="#propflow.core.agents.FactorAgent.ct_creation_params" title="Link to this definition"></a></dt>
<dd><p>Parameters for the cost table creation function.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.agents.FactorAgent.create_from_cost_table">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_from_cost_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cost_table</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/agents.html#FactorAgent.create_from_cost_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.agents.FactorAgent.create_from_cost_table" title="Link to this definition"></a></dt>
<dd><p>Creates a FactorAgent from an existing cost table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The name of the factor.</p></li>
<li><p><strong>cost_table</strong> (<em>CostTable</em>) – The cost table to use.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#propflow.core.agents.FactorAgent" title="propflow.core.agents.FactorAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">FactorAgent</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A new <cite>FactorAgent</cite> instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.agents.FactorAgent.compute_messages">
<span class="sig-name descname"><span class="pre">compute_messages</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/agents.html#FactorAgent.compute_messages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.agents.FactorAgent.compute_messages" title="Link to this definition"></a></dt>
<dd><p>Computes messages to be sent to variable nodes.</p>
<p>Uses the assigned <cite>computator</cite> to calculate messages based on the
cost table and incoming messages from variable nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.agents.FactorAgent.initiate_cost_table">
<span class="sig-name descname"><span class="pre">initiate_cost_table</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/agents.html#FactorAgent.initiate_cost_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.agents.FactorAgent.initiate_cost_table" title="Link to this definition"></a></dt>
<dd><p>Creates the cost table using the provided creation function.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the cost table already exists or if no connections are set.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.agents.FactorAgent.set_dim_for_variable">
<span class="sig-name descname"><span class="pre">set_dim_for_variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/agents.html#FactorAgent.set_dim_for_variable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.agents.FactorAgent.set_dim_for_variable" title="Link to this definition"></a></dt>
<dd><p>Maps a variable to a dimension in the cost table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variable</strong> (<a class="reference internal" href="#propflow.core.agents.VariableAgent" title="propflow.core.agents.VariableAgent"><em>VariableAgent</em></a>) – The variable agent to map.</p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The dimension index in the cost table.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.agents.FactorAgent.set_name_for_factor">
<span class="sig-name descname"><span class="pre">set_name_for_factor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/agents.html#FactorAgent.set_name_for_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.agents.FactorAgent.set_name_for_factor" title="Link to this definition"></a></dt>
<dd><p>Sets the factor’s name based on its connected variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If no connections are set.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.agents.FactorAgent.save_original">
<span class="sig-name descname"><span class="pre">save_original</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/agents.html#FactorAgent.save_original"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.agents.FactorAgent.save_original" title="Link to this definition"></a></dt>
<dd><p>Saves a copy of the original cost table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ct</strong> (<em>CostTable</em><em>, </em><em>optional</em>) – An external cost table to save. Defaults to None.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="propflow.core.agents.FactorAgent.mean_cost">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mean_cost</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><a class="headerlink" href="#propflow.core.agents.FactorAgent.mean_cost" title="Link to this definition"></a></dt>
<dd><p>The mean value of the costs in the cost table.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="propflow.core.agents.FactorAgent.total_cost">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_cost</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><a class="headerlink" href="#propflow.core.agents.FactorAgent.total_cost" title="Link to this definition"></a></dt>
<dd><p>The sum of all costs in the cost table.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="propflow.core.agents.FactorAgent.original_cost_table">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">original_cost_table</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><a class="headerlink" href="#propflow.core.agents.FactorAgent.original_cost_table" title="Link to this definition"></a></dt>
<dd><p>The original, unmodified cost table, if saved.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray | None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-propflow.core.components">
<span id="components"></span><h3>Components<a class="headerlink" href="#module-propflow.core.components" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="propflow.core.components.Message">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">propflow.core.components.</span></span><span class="sig-name descname"><span class="pre">Message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sender</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recipient</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/components.html#Message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.components.Message" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Represents a message passed between agents in the belief propagation algorithm.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.core.components.Message.data">
<span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#propflow.core.components.Message.data" title="Link to this definition"></a></dt>
<dd><p>The content of the message, typically a numpy array
representing costs or beliefs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.core.components.Message.sender">
<span class="sig-name descname"><span class="pre">sender</span></span><a class="headerlink" href="#propflow.core.components.Message.sender" title="Link to this definition"></a></dt>
<dd><p>The agent sending the message.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Agent</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.core.components.Message.recipient">
<span class="sig-name descname"><span class="pre">recipient</span></span><a class="headerlink" href="#propflow.core.components.Message.recipient" title="Link to this definition"></a></dt>
<dd><p>The agent receiving the message.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Agent</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.components.Message.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/components.html#Message.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.components.Message.copy" title="Link to this definition"></a></dt>
<dd><p>Creates a deep copy of the message.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A new <cite>Message</cite> instance with copied data.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#propflow.core.components.Message" title="propflow.core.components.Message">Message</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="propflow.core.components.MailHandler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">propflow.core.components.</span></span><span class="sig-name descname"><span class="pre">MailHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">_domain_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/components.html#MailHandler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.components.MailHandler" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Handles message passing with deduplication and synchronization.</p>
<p>This class manages an agent’s incoming and outgoing messages, ensuring that
only the latest message from each sender is stored.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.core.components.MailHandler.pruning_policy">
<span class="sig-name descname"><span class="pre">pruning_policy</span></span><a class="headerlink" href="#propflow.core.components.MailHandler.pruning_policy" title="Link to this definition"></a></dt>
<dd><p>An optional policy for selectively discarding messages.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.components.MailHandler.set_pruning_policy">
<span class="sig-name descname"><span class="pre">set_pruning_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/components.html#MailHandler.set_pruning_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.components.MailHandler.set_pruning_policy" title="Link to this definition"></a></dt>
<dd><p>Sets a message pruning policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>policy</strong> – An object with a <cite>should_accept_message</cite> method.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.components.MailHandler.set_first_message">
<span class="sig-name descname"><span class="pre">set_first_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">owner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/components.html#MailHandler.set_first_message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.components.MailHandler.set_first_message" title="Link to this definition"></a></dt>
<dd><p>Initializes the inbox with a zero-message from a neighbor.</p>
<p>This is used to ensure that an agent has a message from each neighbor
before computation begins.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>owner</strong> (<a class="reference internal" href="#propflow.core.agents.FGAgent" title="propflow.core.agents.FGAgent"><em>FGAgent</em></a>) – The agent who owns this mail handler.</p></li>
<li><p><strong>neighbor</strong> (<a class="reference internal" href="#propflow.core.agents.FGAgent" title="propflow.core.agents.FGAgent"><em>FGAgent</em></a>) – The neighboring agent to initialize a message from.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.components.MailHandler.receive_messages">
<span class="sig-name descname"><span class="pre">receive_messages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">messages</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/components.html#MailHandler.receive_messages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.components.MailHandler.receive_messages" title="Link to this definition"></a></dt>
<dd><p>Receives and handles one or more messages.</p>
<p>Applies a pruning policy if one is set and stores the message,
overwriting any previous message from the same sender.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>messages</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#propflow.core.components.Message" title="propflow.core.components.Message"><code class="xref py py-class docutils literal notranslate"><span class="pre">Message</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference internal" href="#propflow.core.components.Message" title="propflow.core.components.Message"><code class="xref py py-class docutils literal notranslate"><span class="pre">Message</span></code></a>]</span>) – A single <cite>Message</cite> or a list of <cite>Message</cite> objects.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.components.MailHandler.send">
<span class="sig-name descname"><span class="pre">send</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/components.html#MailHandler.send"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.components.MailHandler.send" title="Link to this definition"></a></dt>
<dd><p>Sends all staged outgoing messages to their recipients.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.components.MailHandler.stage_sending">
<span class="sig-name descname"><span class="pre">stage_sending</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">messages</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/components.html#MailHandler.stage_sending"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.components.MailHandler.stage_sending" title="Link to this definition"></a></dt>
<dd><p>Stages a list of messages to be sent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>messages</strong> (<em>List</em><em>[</em><a class="reference internal" href="#propflow.core.components.Message" title="propflow.core.components.Message"><em>Message</em></a><em>]</em>) – The messages to be sent.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.components.MailHandler.prepare">
<span class="sig-name descname"><span class="pre">prepare</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/components.html#MailHandler.prepare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.components.MailHandler.prepare" title="Link to this definition"></a></dt>
<dd><p>Clears the outbox, typically after messages have been sent.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.components.MailHandler.clear_inbox">
<span class="sig-name descname"><span class="pre">clear_inbox</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/components.html#MailHandler.clear_inbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.components.MailHandler.clear_inbox" title="Link to this definition"></a></dt>
<dd><p>Clears all messages from the inbox.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.core.components.MailHandler.clear_outgoing">
<span class="sig-name descname"><span class="pre">clear_outgoing</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/core/components.html#MailHandler.clear_outgoing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.core.components.MailHandler.clear_outgoing" title="Link to this definition"></a></dt>
<dd><p>Clears all messages from the outbox.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="propflow.core.components.MailHandler.inbox">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inbox</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#propflow.core.components.Message" title="propflow.core.components.Message"><span class="pre">Message</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#propflow.core.components.MailHandler.inbox" title="Link to this definition"></a></dt>
<dd><p>A list of incoming messages.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a>[<a class="reference internal" href="#propflow.core.components.Message" title="propflow.core.components.Message">Message</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="propflow.core.components.MailHandler.outbox">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">outbox</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#propflow.core.components.Message" title="propflow.core.components.Message"><span class="pre">Message</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#propflow.core.components.MailHandler.outbox" title="Link to this definition"></a></dt>
<dd><p>A list of outgoing messages.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a>[<a class="reference internal" href="#propflow.core.components.Message" title="propflow.core.components.Message">Message</a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-propflow.policies">
<span id="policies"></span><h3>Policies<a class="headerlink" href="#module-propflow.policies" title="Link to this heading"></a></h3>
<p>Policies used by belief propagation bp.</p>
<dl class="py function">
<dt class="sig sig-object py" id="propflow.policies.damp">
<span class="sig-prename descclassname"><span class="pre">propflow.policies.</span></span><span class="sig-name descname"><span class="pre">damp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/policies/damping.html#damp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.policies.damp" title="Link to this definition"></a></dt>
<dd><p>Applies damping to the outgoing messages of a single variable agent.</p>
<p>This function updates each outgoing message in the variable’s outbox by
blending it with the corresponding message from the previous iteration.</p>
<p>The update rule is:
<cite>new_message = x * previous_iteration_message + (1 - x) * current_message</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variable</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#propflow.core.agents.VariableAgent" title="propflow.core.agents.VariableAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">VariableAgent</span></code></a></span>) – The <cite>VariableAgent</cite> whose outbox messages will be damped.</p></li>
<li><p><strong>x</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – The damping factor, representing the weight of the previous message.
If None, the default from <cite>POLICY_DEFAULTS</cite> is used.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="propflow.policies.TD">
<span class="sig-prename descclassname"><span class="pre">propflow.policies.</span></span><span class="sig-name descname"><span class="pre">TD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/policies/damping.html#TD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.policies.TD" title="Link to this definition"></a></dt>
<dd><p>Applies temporal damping to the outgoing messages of a list of variables.</p>
<p>This function applies damping using messages from a previous cycle, determined
by the <cite>diameter</cite>. The new message is a weighted average of the message
from <cite>diameter</cite> iterations ago and the current message.</p>
<p>The update rule is:
<cite>new_message = x * previous_cycle_message + (1 - x) * current_message</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference internal" href="#propflow.core.agents.VariableAgent" title="propflow.core.agents.VariableAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">VariableAgent</span></code></a>]</span>) – A list of <cite>VariableAgent</cite> objects to apply damping to.</p></li>
<li><p><strong>x</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – The damping factor, representing the weight of the previous message.
If None, the default from <cite>POLICY_DEFAULTS</cite> is used.</p></li>
<li><p><strong>diameter</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – The number of iterations in a cycle, used to retrieve the
message from the previous cycle. If None, the default from
<cite>POLICY_DEFAULTS</cite> is used.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="propflow.policies.cost_reduction_all_factors_once">
<span class="sig-prename descclassname"><span class="pre">propflow.policies.</span></span><span class="sig-name descname"><span class="pre">cost_reduction_all_factors_once</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/policies/cost_reduction.html#cost_reduction_all_factors_once"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.policies.cost_reduction_all_factors_once" title="Link to this definition"></a></dt>
<dd><p>Applies a one-time cost reduction to all factors in the graph.</p>
<p>This function iterates through all factor agents in the provided factor
graph and multiplies their cost tables by a given factor. It also saves
the original cost table before modification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fg</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#propflow.bp.factor_graph.FactorGraph" title="propflow.bp.factor_graph.FactorGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">FactorGraph</span></code></a></span>) – The <cite>FactorGraph</cite> to modify.</p></li>
<li><p><strong>x</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – The multiplicative factor to apply to the cost tables.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="propflow.policies.discount_attentive">
<span class="sig-prename descclassname"><span class="pre">propflow.policies.</span></span><span class="sig-name descname"><span class="pre">discount_attentive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/policies/cost_reduction.html#discount_attentive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.policies.discount_attentive" title="Link to this definition"></a></dt>
<dd><p>Applies an attentive discount to incoming messages for all variable nodes.</p>
<p>The discount factor for each variable’s messages is inversely proportional
to the variable’s degree in the factor graph. This means variables with more
connections (higher degree) will have their incoming messages discounted more heavily.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fg</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#propflow.bp.factor_graph.FactorGraph" title="propflow.bp.factor_graph.FactorGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">FactorGraph</span></code></a></span>) – The <cite>FactorGraph</cite> containing the variables to be updated.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="propflow.policies.split_all_factors">
<span class="sig-prename descclassname"><span class="pre">propflow.policies.</span></span><span class="sig-name descname"><span class="pre">split_all_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/policies/splitting.html#split_all_factors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.policies.split_all_factors" title="Link to this definition"></a></dt>
<dd><p>Performs an in-place replacement of every factor with two cloned factors.</p>
<p>Each factor <cite>f</cite> with cost table <cite>C</cite> is replaced by two new factors, <cite>f’</cite>
and <cite>f’’</cite>, with cost tables <cite>p*C</cite> and <cite>(1-p)*C</cite>, respectively. The new
factors inherit all the connections of the original factor.</p>
<p>This function directly modifies the provided <cite>FactorGraph</cite> object, including
its underlying <cite>networkx.Graph</cite> and its list of factors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fg</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#propflow.bp.factor_graph.FactorGraph" title="propflow.bp.factor_graph.FactorGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">FactorGraph</span></code></a></span>) – The <cite>FactorGraph</cite> to modify.</p></li>
<li><p><strong>p</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – The splitting proportion, which must be between 0 and 1. This
determines how the original cost is distributed between the two
new factors. If None, the default from <cite>POLICY_DEFAULTS</cite> is used.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.13)"><strong>AssertionError</strong></a> – If <cite>p</cite> is not in the range (0, 1).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="propflow.policies.MessagePruningPolicy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">propflow.policies.</span></span><span class="sig-name descname"><span class="pre">MessagePruningPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prune_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/policies/message_pruning.html#MessagePruningPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.policies.MessagePruningPolicy" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Policy</span></code></p>
<p>A policy that prunes messages that have not changed significantly.</p>
<p>This policy helps to optimize belief propagation by avoiding the processing
of messages that are redundant. It compares the norm of the difference
between a new message and the previous message from the same sender.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.policies.MessagePruningPolicy.prune_threshold">
<span class="sig-name descname"><span class="pre">prune_threshold</span></span><a class="headerlink" href="#propflow.policies.MessagePruningPolicy.prune_threshold" title="Link to this definition"></a></dt>
<dd><p>The threshold for pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.policies.MessagePruningPolicy.min_iterations">
<span class="sig-name descname"><span class="pre">min_iterations</span></span><a class="headerlink" href="#propflow.policies.MessagePruningPolicy.min_iterations" title="Link to this definition"></a></dt>
<dd><p>The number of initial iterations during which
no pruning will occur.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.policies.MessagePruningPolicy.adaptive_threshold">
<span class="sig-name descname"><span class="pre">adaptive_threshold</span></span><a class="headerlink" href="#propflow.policies.MessagePruningPolicy.adaptive_threshold" title="Link to this definition"></a></dt>
<dd><p>If True, the threshold is scaled by the
magnitude of the message.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.policies.MessagePruningPolicy.iteration_count">
<span class="sig-name descname"><span class="pre">iteration_count</span></span><a class="headerlink" href="#propflow.policies.MessagePruningPolicy.iteration_count" title="Link to this definition"></a></dt>
<dd><p>The current iteration number.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.policies.MessagePruningPolicy.pruned_count">
<span class="sig-name descname"><span class="pre">pruned_count</span></span><a class="headerlink" href="#propflow.policies.MessagePruningPolicy.pruned_count" title="Link to this definition"></a></dt>
<dd><p>The total number of pruned messages.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.policies.MessagePruningPolicy.total_count">
<span class="sig-name descname"><span class="pre">total_count</span></span><a class="headerlink" href="#propflow.policies.MessagePruningPolicy.total_count" title="Link to this definition"></a></dt>
<dd><p>The total number of messages considered for pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.policies.MessagePruningPolicy.get_stats">
<span class="sig-name descname"><span class="pre">get_stats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/policies/message_pruning.html#MessagePruningPolicy.get_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.policies.MessagePruningPolicy.get_stats" title="Link to this definition"></a></dt>
<dd><p>Returns statistics about the pruning process.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the pruning rate, total messages considered,
number of pruned messages, and total iterations.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.policies.MessagePruningPolicy.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/policies/message_pruning.html#MessagePruningPolicy.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.policies.MessagePruningPolicy.reset" title="Link to this definition"></a></dt>
<dd><p>Resets the policy’s internal state for a new simulation run.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.policies.MessagePruningPolicy.should_accept_message">
<span class="sig-name descname"><span class="pre">should_accept_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_message</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/policies/message_pruning.html#MessagePruningPolicy.should_accept_message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.policies.MessagePruningPolicy.should_accept_message" title="Link to this definition"></a></dt>
<dd><p>Determines whether to accept or prune an incoming message.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agent</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#propflow.core.agents.FGAgent" title="propflow.core.agents.FGAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">FGAgent</span></code></a></span>) – The agent receiving the message.</p></li>
<li><p><strong>new_message</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#propflow.core.components.Message" title="propflow.core.components.Message"><code class="xref py py-class docutils literal notranslate"><span class="pre">Message</span></code></a></span>) – The new <cite>Message</cite> object.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the message should be accepted, False if it should be pruned.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.policies.MessagePruningPolicy.step_completed">
<span class="sig-name descname"><span class="pre">step_completed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/policies/message_pruning.html#MessagePruningPolicy.step_completed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.policies.MessagePruningPolicy.step_completed" title="Link to this definition"></a></dt>
<dd><p>Signals that a simulation step has completed, incrementing the iteration count.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="propflow.policies.normalize_inbox">
<span class="sig-prename descclassname"><span class="pre">propflow.policies.</span></span><span class="sig-name descname"><span class="pre">normalize_inbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/policies/normalize_cost.html#normalize_inbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.policies.normalize_inbox" title="Link to this definition"></a></dt>
<dd><p>Normalizes all messages in the inboxes of a list of variable agents.</p>
<p>This function iterates through each variable’s inbox and last iteration’s
messages, normalizing them by subtracting the minimum value. This centers
the message values around zero without changing their relative differences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>variables</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference internal" href="#propflow.core.agents.VariableAgent" title="propflow.core.agents.VariableAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">VariableAgent</span></code></a>]</span>) – A list of <cite>VariableAgent</cite> objects whose messages will be
normalized.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="propflow.policies.normalize_soft_max">
<span class="sig-prename descclassname"><span class="pre">propflow.policies.</span></span><span class="sig-name descname"><span class="pre">normalize_soft_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cost_table</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/policies/normalize_cost.html#normalize_soft_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.policies.normalize_soft_max" title="Link to this definition"></a></dt>
<dd><p>Normalizes a cost table using the softmax function.</p>
<p>This ensures all values are positive and sum to 1, effectively converting
costs into a probability distribution. A stability trick (subtracting the
max value) is used to prevent overflow with large cost values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cost_table</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – An n-dimensional numpy array representing the cost table.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The normalized cost table.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="propflow.policies.normalize_cost_table_sum">
<span class="sig-prename descclassname"><span class="pre">propflow.policies.</span></span><span class="sig-name descname"><span class="pre">normalize_cost_table_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cost_table</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/policies/normalize_cost.html#normalize_cost_table_sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.policies.normalize_cost_table_sum" title="Link to this definition"></a></dt>
<dd><p>Normalizes a cost table so that the sum across all dimensions is equal.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The implementation of this function appears to be incorrect for its
stated purpose and may not produce the intended normalization.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cost_table</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – An n-dimensional numpy array representing the cost table.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The modified cost table.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="propflow.policies.init_normalization">
<span class="sig-prename descclassname"><span class="pre">propflow.policies.</span></span><span class="sig-name descname"><span class="pre">init_normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">li</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/policies/normalize_cost.html#init_normalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.policies.init_normalization" title="Link to this definition"></a></dt>
<dd><p>Performs an initial normalization of cost tables for a list of factors.</p>
<p>This function divides each factor’s cost table by the total number of
factors in the list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>li</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference internal" href="#propflow.core.agents.FactorAgent" title="propflow.core.agents.FactorAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">FactorAgent</span></code></a>]</span>) – A list of <cite>FactorAgent</cite> objects to be normalized.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-propflow.utils">
<span id="utilities"></span><h3>Utilities<a class="headerlink" href="#module-propflow.utils" title="Link to this heading"></a></h3>
</section>
<section id="module-propflow.simulator">
<span id="simulator"></span><h3>Simulator<a class="headerlink" href="#module-propflow.simulator" title="Link to this heading"></a></h3>
<p>A parallelized simulator for running and comparing multiple engine configurations.</p>
<p>This module provides a <cite>Simulator</cite> class that can run multiple belief propagation
engine configurations across a set of factor graphs in parallel. It uses Python’s
<cite>multiprocessing</cite> module to distribute the simulation runs, collects the results,
and provides a simple plotting utility to visualize and compare the performance
of different engines.</p>
<dl class="py class">
<dt class="sig sig-object py" id="propflow.simulator.Simulator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">propflow.simulator.</span></span><span class="sig-name descname"><span class="pre">Simulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">engine_configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/simulator.html#Simulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.simulator.Simulator" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Orchestrates parallel execution of multiple simulation configurations.</p>
<p>This class takes a set of engine configurations and a list of factor graphs,
runs each engine on each graph in parallel, collects the cost history from
each run, and provides methods to visualize the aggregated results.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.simulator.Simulator.engine_configs">
<span class="sig-name descname"><span class="pre">engine_configs</span></span><a class="headerlink" href="#propflow.simulator.Simulator.engine_configs" title="Link to this definition"></a></dt>
<dd><p>A dictionary mapping engine names to their configurations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.simulator.Simulator.logger">
<span class="sig-name descname"><span class="pre">logger</span></span><a class="headerlink" href="#propflow.simulator.Simulator.logger" title="Link to this definition"></a></dt>
<dd><p>A configured logger instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Logger</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.simulator.Simulator.results">
<span class="sig-name descname"><span class="pre">results</span></span><a class="headerlink" href="#propflow.simulator.Simulator.results" title="Link to this definition"></a></dt>
<dd><p>A dictionary to store the results of the simulations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="propflow.simulator.Simulator.timeout">
<span class="sig-name descname"><span class="pre">timeout</span></span><a class="headerlink" href="#propflow.simulator.Simulator.timeout" title="Link to this definition"></a></dt>
<dd><p>The timeout in seconds for multiprocessing tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.simulator.Simulator.run_simulations">
<span class="sig-name descname"><span class="pre">run_simulations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graphs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/simulator.html#Simulator.run_simulations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.simulator.Simulator.run_simulations" title="Link to this definition"></a></dt>
<dd><p>Runs all engine configurations on all provided graphs in parallel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graphs</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span>) – A list of factor graph objects to run simulations on.</p></li>
<li><p><strong>max_iter</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – The maximum number of iterations for each simulation run.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]]]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary containing the collected results, where keys are engine
names and values are lists of cost histories for each run.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.simulator.Simulator.plot_results">
<span class="sig-name descname"><span class="pre">plot_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/simulator.html#Simulator.plot_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.simulator.Simulator.plot_results" title="Link to this definition"></a></dt>
<dd><p>Plots the average cost convergence for each engine configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_iter</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – The maximum number of iterations to display on the plot.</p></li>
<li><p><strong>verbose</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – If True, plots individual simulation runs with transparency
and standard deviation bands around the average.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="propflow.simulator.Simulator.set_log_level">
<span class="sig-name descname"><span class="pre">set_log_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/propflow/simulator.html#Simulator.set_log_level"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#propflow.simulator.Simulator.set_log_level" title="Link to this definition"></a></dt>
<dd><p>Sets the logging level for the simulator’s logger.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>level</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The desired logging level (e.g., ‘INFO’, ‘DEBUG’).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../user_guide.html" class="btn btn-neutral float-left" title="User Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../examples.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Or Muller.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>